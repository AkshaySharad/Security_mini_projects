import os

# Define malware signatures
malware_signatures = [
    "malicious_code_signature_1",
    "malicious_code_signature_2",
    "malicious_code_signature_3",
    # Add more signatures here
]


def scan_file_for_signatures(file_path, signatures):
    try:
        with open(file_path, 'rb') as file:
            file_content = file.read()

            for signature in signatures:
                if signature.encode() in file_content:
                    print(f"Malware signature found in {file_path}: {signature}")
                    return True
        return False
    except Exception as e:
        print(f"Could not scan {file_path}: {e}")
        return False


def scan_directory(directory_path, signatures):
    for root, dirs, files in os.walk(directory_path):
        for file in files:
            file_path = os.path.join(root, file)
            if scan_file_for_signatures(file_path, signatures):
                print(f"Malware found in file: {file_path}")


if __name__ == "__main__":
    directory_to_scan = "path/to/directory"  # Update this path
    scan_directory(directory_to_scan, malware_signatures)
